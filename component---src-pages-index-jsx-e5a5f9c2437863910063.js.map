{"version":3,"sources":["webpack:///./src/components/Search/SearchForm.jsx","webpack:///./src/components/Search/SearchResult.jsx","webpack:///./src/pages/index.jsx"],"names":["SearchForm","props","_this","_Component","call","this","handleChange","bind","assertThisInitialized_default","e","value","target","onQueryChange","render","query","react_default","a","createElement","Form_default","Group","Label","srOnly","Control","type","placeholder","onChange","Component","defaultProps","propTypes","PropTypes","func","string","SearchResult","_ref","transmitter","areaServed","band","callsign","distance","frequency","id","purpose","siteName","state","className","gatsby_browser_entry","to","toFixed","antennaHeight","latitude","longitude","onAirID","isRequired","IndexPage","getInfo","coords","position","latLng","lat","lng","transmitterListingSorted","transmitterListing","map","transmitterWithDistance","geodist","exact","unit","sort","b","length","filter","match","RegExp","setState","results","slice","getLocation","geolocation","navigator","Promise","resolve","reject","Error","getCurrentPosition","then","handleQueryChange","componentDidMount","_this2","_this$state","searchResults","key","Search_SearchResult","Layout","Search_SearchForm"],"mappings":"6OAKMA,cAWJ,SAAAA,EAAYC,GAAO,IAAAC,EAAA,OACjBA,EAAAC,EAAAC,KAAAC,KAAMJ,IAANI,MAEKC,aAAeJ,EAAKI,aAAaC,KAAlBC,QAAAN,KAHHA,sCAMnBI,sBAAaG,GAAG,IACNC,EAAUD,EAAEE,OAAZD,OAGRE,EAF0BP,KAAKJ,MAAvBW,eAEMF,MAGhBG,kBAAS,IACCC,EAAUT,KAAKJ,MAAfa,MAER,OACEC,EAAAC,EAAAC,cAACC,EAAAF,EAAD,KACED,EAAAC,EAAAC,cAACC,EAAAF,EAAKG,MAAN,KACEJ,EAAAC,EAAAC,cAACC,EAAAF,EAAKI,MAAN,CAAYC,QAAM,GAAlB,UACAN,EAAAC,EAAAC,cAACC,EAAAF,EAAKM,QAAN,CACEC,KAAK,OACLC,YAAY,iBACZd,MAAOI,EACPW,SAAUpB,KAAKC,qBAnCFoB,aAAnB1B,EACG2B,aAAe,CACpBf,cAAe,KACfE,MAAO,MAHLd,EAMG4B,UAAY,CACjBhB,cAAeiB,IAAUC,KACzBhB,MAAOe,IAAUE,QAmCN/B,iBC3CTgC,EAAe,SAAAC,GAAqB,IAAlBC,EAAkBD,EAAlBC,YAIpBC,EA2BED,EA3BFC,WAEAC,EAyBEF,EAzBFE,KACAC,EAwBEH,EAxBFG,SACAC,EAuBEJ,EAvBFI,SAEAC,EAqBEL,EArBFK,UAEAC,EAmBEN,EAnBFM,GAWAC,EAQEP,EARFO,QAEAC,EAMER,EANFQ,SACAC,EAKET,EALFS,MAOF,OACE5B,EAAAC,EAAAC,cAAA,OAAK2B,UAAU,eACb7B,EAAAC,EAAAC,cAAC4B,EAAA,KAAD,CAAMC,GAAE,iBAAmBN,EAAnB,KACNzB,EAAAC,EAAAC,cAAA,UACGoB,EACA,IACAE,EACAH,GAEHrB,EAAAC,EAAAC,cAAA,SACIyB,EADJ,IAGG,IACCP,EAJJ,IAMG,IACCQ,GAEJ5B,EAAAC,EAAAC,cAAA,qBAEIqB,EAASS,QAAQ,GAFrB,MAKAhC,EAAAC,EAAAC,cAAA,SACEF,EAAAC,EAAAC,cAAA,QAAM2B,UAAU,uBAAwBH,OAOlDT,EAAaJ,UAAY,CACvBM,YAAaL,QAAgB,CAC3BmB,cAAenB,SACfM,WAAYN,SACZO,KAAMP,SACNQ,SAAUR,SACVS,SAAUT,SACVU,UAAWV,SACXW,GAAIX,SACJoB,SAAUpB,SACVqB,UAAWrB,SACXsB,QAAStB,SACTY,QAASZ,SACTa,SAAUb,SACVc,MAAOd,WACNuB,YAGUpB,iBC7ETqB,cAKJ,SAAAA,EAAYpD,GAAO,IAAAC,EAAA,OACjBA,EAAAC,EAAAC,KAAAC,KAAMJ,IAANI,MAeFiD,QAAU,WAAM,IAENC,EADarD,EAAKyC,MAAlBa,SACAD,OAEFE,EAAS,CACbC,IAF8BH,EAAxBN,SAGNU,IAH8BJ,EAAdL,WAKVpC,EAAUZ,EAAKyC,MAAf7B,MAEJ8C,EAA2BC,EAAmBC,IAAI,SAAC5B,GACrD,IAAM6B,EAA0B7B,EAMhC,OALA6B,EAAwBzB,SAAW0B,IACjCP,EACA,CAAEC,IAAKxB,EAAYe,SAAUU,IAAKzB,EAAYgB,WAC9C,CAAEe,OAAO,EAAMC,KAAM,OAEhBH,IAETH,EAA2BA,EAAyBO,KAAK,SAACnD,EAAGoD,GAAJ,OAAUpD,EAAEsB,SAAW8B,EAAE9B,WAE9ExB,EAAMuD,OAAS,IACjBT,EAA2BA,EAAyBU,OAAO,SAACpC,GAAgB,IAClEG,EAAaH,EAAbG,SACR,OAAiB,OAAbA,GAG8C,OAA3CA,EAASkC,MAAM,IAAIC,OAAO1D,EAAO,SAI5CZ,EAAKuE,SAAS,CAAEC,QAASd,EAAyBe,MAAM,EAAG,QA/C1CzE,EAkDnB0E,YAAc,WAAM,IACVC,EAAgBC,UAAhBD,YAES,IAAIE,QAAQ,SAACC,EAASC,GAChCJ,GACHI,EAAO,IAAIC,MAAM,kBAGnBL,EAAYM,mBAAmB,SAAC3B,GAC9BwB,EAAQxB,IACP,WACDyB,EAAO,IAAIC,MAAM,0BAIZE,KAAK,SAAC5B,GACbtD,EAAKuE,SAAS,CACZjB,YACC,WACDtD,EAAKoD,eAlETpD,EAAKmF,kBAAoBnF,EAAKmF,kBAAkB9E,KAAvBC,QAAAN,KAEzBA,EAAKyC,MAAQ,CACX7B,MAAO,GACP0C,SAAU,KACVkB,QAAS,IARMxE,sCAYnBoF,6BACEjF,KAAKuE,iBA6DPS,2BAAkBvE,GAAO,IAAAyE,EAAAlF,KACvBA,KAAKoE,SAAS,CACZ3D,SACC,WACDyE,EAAKjC,eAITzC,kBAAS,IAAA2E,EACoBnF,KAAKsC,MAAxB7B,EADD0E,EACC1E,MAEF2E,EAHCD,EACQd,QAEeZ,IAAI,SAAC5B,GAAgB,IACzCM,EAAON,EAAPM,GAER,OACEzB,EAAAC,EAAAC,cAAA,MAAI2B,UAAU,kBAAkB8C,IAAKlD,GACnCzB,EAAAC,EAAAC,cAAC0E,EAAD,CAAczD,YAAaA,EAAawD,IAAKlD,OAKnD,OACEzB,EAAAC,EAAAC,cAAC2E,EAAA,EAAD,KACE7E,EAAAC,EAAAC,cAAA,OAAK2B,UAAU,aACb7B,EAAAC,EAAAC,cAAA,OAAK2B,UAAU,OACb7B,EAAAC,EAAAC,cAAA,OAAK2B,UAAU,OACb7B,EAAAC,EAAAC,cAAC4E,EAAD,CACE/E,MAAOA,EACPF,cAAeP,KAAKgF,oBAEtBtE,EAAAC,EAAAC,cAAA,OAAK2B,UAAU,QACb7B,EAAAC,EAAAC,cAAA,OAAK2B,UAAU,eAAf,gBACA7B,EAAAC,EAAAC,cAAA,MAAI2B,UAAU,+BACV6C,YAhHI/D,aAAlB2B,EACG1B,aAAe,GADlB0B,EAGGzB,UAAY,GAwHNyB","file":"component---src-pages-index-jsx-e5a5f9c2437863910063.js","sourcesContent":["import PropTypes from 'prop-types';\nimport React, { Component } from 'react';\n\nimport Form from 'react-bootstrap/lib/Form';\n\nclass SearchForm extends Component {\n  static defaultProps = {\n    onQueryChange: null,\n    query: null,\n  }\n\n  static propTypes = {\n    onQueryChange: PropTypes.func,\n    query: PropTypes.string,\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  handleChange(e) {\n    const { value } = e.target;\n    const { onQueryChange } = this.props;\n\n    onQueryChange(value);\n  }\n\n  render() {\n    const { query } = this.props;\n\n    return (\n      <Form>\n        <Form.Group>\n          <Form.Label srOnly>Filter</Form.Label>\n          <Form.Control\n            type=\"text\"\n            placeholder=\"Refine results\"\n            value={query}\n            onChange={this.handleChange}\n          />\n        </Form.Group>\n      </Form>\n    );\n  }\n}\n\nexport default SearchForm;\n","import * as PropTypes from 'prop-types';\nimport React from 'react';\n\nimport { Link } from 'gatsby';\n\nconst SearchResult = ({ transmitter }) => {\n  const {\n    // antennaHeight,\n    // antennaPattern,\n    areaServed,\n    // bSL,\n    band,\n    callsign,\n    distance,\n    // easting,\n    frequency,\n    // hoursofOperation,\n    id,\n    // latitude,\n    // licenceArea,\n    // licenceAreaID,\n    // licenceNumber,\n    // longitude,\n    // maximumCMF,\n    // maximumERP,\n    // northing,\n    // onAirID,\n    // polarisation,\n    purpose,\n    // siteId,\n    siteName,\n    state,\n    // status,\n    // technicalSpecificationNumber,\n    // transmitterPower,\n    // zone,\n  } = transmitter;\n\n  return (\n    <div className=\"transmitter\">\n      <Link to={`/transmitters/${id}/`}>\n        <h5>\n          {callsign}\n          {' '}\n          {frequency}\n          {band}\n        </h5>\n        <p>\n          { siteName }\n,\n          {' '}\n          { areaServed }\n,\n          {' '}\n          { state }\n        </p>\n        <p>\nDistance:\n          { distance.toFixed(2) }\nkm\n        </p>\n        <p>\n          <span className=\"badge badge-primary\">{ purpose }</span>\n        </p>\n      </Link>\n    </div>\n  );\n};\n\nSearchResult.propTypes = {\n  transmitter: PropTypes.shape({\n    antennaHeight: PropTypes.string,\n    areaServed: PropTypes.string,\n    band: PropTypes.string,\n    callsign: PropTypes.string,\n    distance: PropTypes.number,\n    frequency: PropTypes.string,\n    id: PropTypes.string,\n    latitude: PropTypes.number,\n    longitude: PropTypes.number,\n    onAirID: PropTypes.string,\n    purpose: PropTypes.string,\n    siteName: PropTypes.string,\n    state: PropTypes.string,\n  }).isRequired,\n};\n\nexport default SearchResult;\n","import React, { Component } from 'react';\n\nimport geodist from 'geodist';\n\nimport Layout from '../components/Layout';\nimport SearchForm from '../components/Search/SearchForm';\nimport SearchResult from '../components/Search/SearchResult';\n\nimport transmitterListing from '../data/acma/transmitter_listing_20110702.json';\n\nclass IndexPage extends Component {\n  static defaultProps = {}\n\n  static propTypes = {}\n\n  constructor(props) {\n    super(props);\n\n    this.handleQueryChange = this.handleQueryChange.bind(this);\n\n    this.state = {\n      query: '',\n      position: null,\n      results: [],\n    };\n  }\n\n  componentDidMount() {\n    this.getLocation();\n  }\n\n  getInfo = () => {\n    const { position } = this.state;\n    const { coords } = position;\n    const { latitude, longitude } = coords;\n    const latLng = {\n      lat: latitude,\n      lng: longitude,\n    };\n    const { query } = this.state;\n\n    let transmitterListingSorted = transmitterListing.map((transmitter) => {\n      const transmitterWithDistance = transmitter;\n      transmitterWithDistance.distance = geodist(\n        latLng,\n        { lat: transmitter.latitude, lng: transmitter.longitude },\n        { exact: true, unit: 'km' },\n      );\n      return transmitterWithDistance;\n    });\n    transmitterListingSorted = transmitterListingSorted.sort((a, b) => a.distance - b.distance);\n\n    if (query.length > 1) {\n      transmitterListingSorted = transmitterListingSorted.filter((transmitter) => {\n        const { callsign } = transmitter;\n        if (callsign === null) {\n          return false;\n        }\n        return callsign.match(new RegExp(query, 'i')) !== null;\n      });\n    }\n\n    this.setState({ results: transmitterListingSorted.slice(0, 100) });\n  }\n\n  getLocation = () => {\n    const { geolocation } = navigator;\n\n    const location = new Promise((resolve, reject) => {\n      if (!geolocation) {\n        reject(new Error('Not Supported'));\n      }\n\n      geolocation.getCurrentPosition((position) => {\n        resolve(position);\n      }, () => {\n        reject(new Error('Permission denied'));\n      });\n    });\n\n    location.then((position) => {\n      this.setState({\n        position,\n      }, () => {\n        this.getInfo();\n      });\n    });\n  }\n\n  handleQueryChange(query) {\n    this.setState({\n      query,\n    }, () => {\n      this.getInfo();\n    });\n  }\n\n  render() {\n    const { query, results } = this.state;\n\n    const searchResults = results.map((transmitter) => {\n      const { id } = transmitter;\n\n      return (\n        <li className=\"list-group-item\" key={id}>\n          <SearchResult transmitter={transmitter} key={id} />\n        </li>\n      );\n    });\n\n    return (\n      <Layout>\n        <div className=\"container\">\n          <div className=\"row\">\n            <div className=\"col\">\n              <SearchForm\n                query={query}\n                onQueryChange={this.handleQueryChange}\n              />\n              <div className=\"card\">\n                <div className=\"card-header\">Transmitters</div>\n                <ul className=\"list-group list-group-flush\">\n                  { searchResults }\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </Layout>\n    );\n  }\n}\n\nexport default IndexPage;\n"],"sourceRoot":""}